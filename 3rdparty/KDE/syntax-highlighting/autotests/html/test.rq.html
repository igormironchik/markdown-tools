<!DOCTYPE html>
<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<title>test.rq</title>
<meta name="generator" content="KF5::SyntaxHighlighting - Definition (SPARQL) - Theme (Breeze Light)"/>
</head><body style="background-color:#ffffff;color:#1f1c1b"><pre>
<span style="color:#898887"># SPARQL Query for Syntax Highlighting Test</span>
<span style="color:#898887"># This query includes a wide range of features to test a highlighter's capabilities.</span>

<span style="color:#898887"># == 1. Prologue: Base URI and Prefixes</span>
<span style="font-weight:bold">BASE</span>          <span style="color:#bf0303">&lt;http://example.org/book-data/></span>
<span style="font-weight:bold">PREFIX</span> ex:    <span style="color:#bf0303">&lt;http://example.org/vocab#></span>
<span style="font-weight:bold">PREFIX</span> foaf:  <span style="color:#bf0303">&lt;http://xmlns.com/foaf/0.1/></span>
<span style="font-weight:bold">PREFIX</span> rdf:   <span style="color:#bf0303">&lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#></span>
<span style="font-weight:bold">PREFIX</span> rdfs:  <span style="color:#bf0303">&lt;http://www.w3.org/2000/01/rdf-schema#></span>
<span style="font-weight:bold">PREFIX</span> xsd:   <span style="color:#bf0303">&lt;http://www.w3.org/2001/XMLSchema#></span>
<span style="font-weight:bold">PREFIX</span> dc:    <span style="color:#bf0303">&lt;http://purl.org/dc/elements/1.1/></span>

<span style="color:#898887"># == 2. Query Form: SELECT with Expressions and Aggregates</span>
<span style="font-weight:bold">SELECT</span> <span style="font-weight:bold">DISTINCT</span>
    ?authorName
    <span style="color:#ca60ca">(</span><span style="color:#644a9b">UCASE</span><span style="color:#ca60ca">(</span>?title<span style="color:#ca60ca">)</span> <span style="font-weight:bold">AS</span> ?upperCaseTitle<span style="color:#ca60ca">)</span>
    ?publicationDate
    <span style="color:#898887"># Aggregate functions</span>
    <span style="color:#ca60ca">(</span><span style="color:#644a9b">COUNT</span><span style="color:#ca60ca">(</span>?character<span style="color:#ca60ca">)</span> <span style="font-weight:bold">AS</span> ?characterCount<span style="color:#ca60ca">)</span>
    <span style="color:#ca60ca">(</span><span style="color:#644a9b">GROUP_CONCAT</span><span style="color:#ca60ca">(</span><span style="font-weight:bold">DISTINCT</span> ?genre<span style="color:#ca60ca">;</span> SEPARATOR<span style="color:#ca60ca">=</span><span style="color:#bf0303">", "</span><span style="color:#ca60ca">)</span> <span style="font-weight:bold">AS</span> ?genres<span style="color:#ca60ca">)</span>
    <span style="color:#ca60ca">(</span><span style="color:#644a9b">AVG</span><span style="color:#ca60ca">(</span>?rating<span style="color:#ca60ca">)</span> <span style="font-weight:bold">AS</span> ?averageRating<span style="color:#ca60ca">)</span>

<span style="color:#898887"># == 3. Dataset Clause: Defining the Query Target</span>
<span style="font-weight:bold">FROM</span> <span style="color:#bf0303">&lt;http://example.org/library-main-graph></span>
<span style="font-weight:bold">FROM</span> <span style="font-weight:bold">NAMED</span> <span style="color:#bf0303">&lt;http://example.org/library-metadata-graph></span>

<span style="color:#898887"># == 4. Query Pattern: The Core Logic</span>
<span style="font-weight:bold">WHERE</span> <span style="color:#ca60ca">{</span>
    <span style="color:#898887"># Inline data with VALUES</span>
    <span style="font-weight:bold">VALUES</span> ?authorType <span style="color:#ca60ca">{</span> foaf:Person ex:FictionalEntity <span style="color:#ca60ca">}</span>

    <span style="color:#898887"># Basic Graph Pattern with various term types</span>
    ?author a foaf:person <span style="color:#ca60ca">;</span>
            rdf:type ?authorType <span style="color:#ca60ca">;</span>
            foaf:name ?authorName <span style="color:#ca60ca">;</span>
            foaf:birthday ?birthDate <span style="color:#ca60ca">.</span> <span style="color:#898887"># Semicolon for predicate-object lists</span>

    ?author foaf:smoker true <span style="color:#ca60ca">.</span>
    ?author foaf:child false <span style="color:#ca60ca">.</span>

    <span style="color:#898887"># Property path: one or more 'knows' relationships</span>
    ?author foaf:knows<span style="color:#ca60ca">+</span> ?colleague <span style="color:#ca60ca">.</span>

    <span style="color:#898887"># Nested blank node syntax</span>
    ?book dc:creator <span style="color:#ca60ca">[</span> foaf:name ?authorName <span style="color:#ca60ca">]</span> <span style="color:#ca60ca">;</span>
          dc:title ?title <span style="color:#ca60ca">;</span>
          ex:rating ?rating <span style="color:#ca60ca">.</span> <span style="color:#898887"># Period to end the triple block.</span>

    <span style="color:#898887"># OPTIONAL block for data that may not exist</span>
    <span style="font-weight:bold">OPTIONAL</span> <span style="color:#ca60ca">{</span>
        ?book ex:hasCharacter ?character <span style="color:#ca60ca">.</span>
        ?character foaf:name ?characterName <span style="color:#ca60ca">.</span>
    <span style="color:#ca60ca">}</span>

    <span style="color:#898887"># UNION to combine results from alternative patterns</span>
    <span style="color:#ca60ca">{</span>
        ?book ex:genre <span style="color:#bf0303">"Science Fiction"</span>@en <span style="color:#ca60ca">.</span>
    <span style="color:#ca60ca">}</span>
    <span style="font-weight:bold">UNION</span>
    <span style="color:#ca60ca">{</span>
        ?book ex:genre <span style="color:#bf0303">"Fantasy"</span><span style="color:#ca60ca">^^</span>xsd:string <span style="color:#ca60ca">.</span>
    <span style="color:#ca60ca">}</span>

    <span style="color:#898887"># BIND to compute and assign a new variable</span>
    <span style="font-weight:bold">BIND</span><span style="color:#ca60ca">(</span><span style="color:#644a9b">YEAR</span><span style="color:#ca60ca">(</span>?birthDate<span style="color:#ca60ca">)</span> <span style="font-weight:bold">AS</span> ?birthYear<span style="color:#ca60ca">)</span>

    <span style="color:#898887"># Subquery to pre-filter books</span>
    <span style="color:#ca60ca">{</span>
      <span style="font-weight:bold">SELECT</span> ?book ?publicationDate <span style="font-weight:bold">WHERE</span> <span style="color:#ca60ca">{</span>
        ?book dc:date ?publicationDate <span style="color:#ca60ca">.</span>
        <span style="font-weight:bold">FILTER</span><span style="color:#ca60ca">(</span>?publicationDate <span style="color:#ca60ca">></span> <span style="color:#bf0303">"2000-01-01T00:00:00"</span><span style="color:#ca60ca">^^</span>xsd:dateTime <span style="color:#ca60ca">&amp;&amp;</span> ?publicationDate <span style="color:#ca60ca">&lt;</span> <span style="color:#bf0303">"2010-01-01T00:00:00"</span><span style="color:#ca60ca">^^</span>xsd:dateTime<span style="color:#ca60ca">)</span>
      <span style="color:#ca60ca">}</span>
      <span style="font-weight:bold">LIMIT</span> <span style="color:#b08000">100</span>
    <span style="color:#ca60ca">}</span>

    <span style="color:#898887"># GRAPH clause to query a specific named graph</span>
    <span style="font-weight:bold">GRAPH</span> <span style="color:#bf0303">&lt;http://example.org/library-metadata-graph></span> <span style="color:#ca60ca">{</span>
        ?book ex:reviewedBy _:reviewer <span style="color:#ca60ca">.</span> <span style="color:#898887"># Blank node label</span>
    <span style="color:#ca60ca">}</span>

    <span style="color:#898887"># SERVICE clause for federated queries</span>
    <span style="font-weight:bold">SERVICE</span> <span style="color:#bf0303">&lt;http://dbpedia.org/sparql></span> <span style="color:#ca60ca">{</span>
        ?colleague rdfs:label ?colleagueLabel <span style="color:#ca60ca">.</span>
        <span style="font-weight:bold">FILTER</span><span style="color:#ca60ca">(</span><span style="color:#644a9b">LANG</span><span style="color:#ca60ca">(</span>?colleagueLabel<span style="color:#ca60ca">)</span> <span style="color:#ca60ca">=</span> <span style="color:#bf0303">"en"</span><span style="color:#ca60ca">)</span>
    <span style="color:#ca60ca">}</span>

    <span style="color:#898887"># FILTER clause with a variety of functions and operators</span>
    <span style="font-weight:bold">FILTER</span> <span style="color:#ca60ca">(</span>
        <span style="color:#898887"># Logical, comparison, and arithmetic</span>
        <span style="color:#ca60ca">(</span>?rating <span style="color:#ca60ca">></span> <span style="color:#b08000">3.5</span> <span style="color:#ca60ca">&amp;&amp;</span> ?birthYear <span style="color:#ca60ca">&lt;</span> <span style="color:#b08000">1980</span><span style="color:#ca60ca">)</span> <span style="color:#ca60ca">||</span>
        <span style="color:#898887"># Regular expression</span>
        <span style="color:#644a9b">REGEX</span><span style="color:#ca60ca">(</span>?authorName<span style="color:#ca60ca">,</span> <span style="color:#bf0303">"^J</span><span style="color:#924c9d">\\</span><span style="color:#bf0303">.</span><span style="color:#924c9d">\\</span><span style="color:#bf0303">s?K</span><span style="color:#924c9d">\\</span><span style="color:#bf0303">."</span><span style="color:#ca60ca">,</span> <span style="color:#bf0303">"i"</span><span style="color:#ca60ca">)</span> <span style="color:#ca60ca">&amp;&amp;</span>
        <span style="color:#898887"># Check for existence of a value</span>
        <span style="color:#644a9b">BOUND</span><span style="color:#ca60ca">(</span>?characterName<span style="color:#ca60ca">)</span> <span style="color:#ca60ca">&amp;&amp;</span>
        <span style="color:#898887"># String and numeric functions</span>
        <span style="color:#ca60ca">(</span><span style="color:#644a9b">STRLEN</span><span style="color:#ca60ca">(</span>?title<span style="color:#ca60ca">)</span> <span style="color:#ca60ca">-</span> <span style="color:#b08000">5</span> <span style="color:#ca60ca">></span> <span style="color:#b08000">10</span><span style="color:#ca60ca">)</span> <span style="color:#ca60ca">&amp;&amp;</span>
        <span style="color:#898887"># IN operator</span>
        ?genre <span style="font-weight:bold">IN</span> <span style="color:#ca60ca">(</span><span style="color:#bf0303">"Fantasy"</span><span style="color:#ca60ca">,</span> <span style="color:#bf0303">"Sci-Fi"</span><span style="color:#ca60ca">)</span> <span style="color:#ca60ca">&amp;&amp;</span>
        <span style="color:#898887"># Datatype and language checks</span>
        <span style="color:#644a9b">LANGMATCHES</span><span style="color:#ca60ca">(</span><span style="color:#644a9b">LANG</span><span style="color:#ca60ca">(</span>?title<span style="color:#ca60ca">),</span> <span style="color:#bf0303">"en-US"</span><span style="color:#ca60ca">)</span> <span style="color:#ca60ca">&amp;&amp;</span>
        <span style="color:#644a9b">DATATYPE</span><span style="color:#ca60ca">(</span>?rating<span style="color:#ca60ca">)</span> <span style="color:#ca60ca">=</span> xsd:decimal
    <span style="color:#ca60ca">)</span>

    <span style="font-weight:bold">FILTER</span> <span style="font-weight:bold">NOT</span> <span style="font-weight:bold">EXISTS</span> <span style="color:#ca60ca">{</span>
        ?colleague schema:memberOf ?organization <span style="color:#ca60ca">.</span>
    <span style="color:#ca60ca">}</span>
<span style="color:#ca60ca">}</span>

<span style="color:#898887"># == 5. Solution Modifiers: Ordering, Grouping, and Slicing</span>
<span style="font-weight:bold">GROUP</span> <span style="font-weight:bold">BY</span> ?authorName ?title ?publicationDate
<span style="font-weight:bold">HAVING</span> <span style="color:#ca60ca">(</span><span style="color:#644a9b">COUNT</span><span style="color:#ca60ca">(</span>?character<span style="color:#ca60ca">)</span> <span style="color:#ca60ca">>=</span> <span style="color:#b08000">2</span><span style="color:#ca60ca">)</span> <span style="color:#898887"># Filter on aggregate results</span>
<span style="font-weight:bold">ORDER</span> <span style="font-weight:bold">BY</span> <span style="font-weight:bold">DESC</span><span style="color:#ca60ca">(</span>?averageRating<span style="color:#ca60ca">)</span> <span style="font-weight:bold">ASC</span><span style="color:#ca60ca">(</span>?authorName<span style="color:#ca60ca">)</span>
<span style="font-weight:bold">LIMIT</span> <span style="color:#b08000">10</span>
<span style="font-weight:bold">OFFSET</span> <span style="color:#b08000">20</span>

<span style="color:#898887"># == Other SPARQL Keywords (for syntax highlighting completeness)</span>
<span style="color:#898887"># CONSTRUCT, DESCRIBE, ASK (alternative query forms)</span>
<span style="color:#898887"># INSERT DATA, DELETE DATA, LOAD, CLEAR, CREATE, DROP (update operations)</span>
</pre></body></html>
